**Виконали:** *студенти групи ІС-73*

*Турко Микола, Шеляхіна Владислава*

---

## Змістовна постановка задачі
Для виконання деякого виду робіт є необхідність придбати $N$ метрів тканини. 
Є $m$ постачальників цієї тканини. Ціна за метр тканини при купівлі її у $i$ -го постачальника складає $$c_i$$  одиниць вартості, $i = 1,...,m$ . Тканина може закуповуватися тільки цілою кількістю метрів. 

Кожен з постачальників може надати знижку: за умови, якщо замовлення перевищує $n_i$  метрів $(\sum_{i=1}^{m} n_i < N )$. 
Ціна за метр тканини при купівлі її у $i$ -го постачальника складає $s_i$  одиниць вартості ($s_i < c_i, i = 1,...,m$). При цьому: $(\sum_{i=1}^{m} n_i < N )$.

Запаси тканини у $i$ -го постачальника обмежені обсягом $v_i$ метрів $(\sum_{i=1}^{m} v_i > N )$. . 

**Визначити** обсяги закупівлі тканини у постачальників, при яких досягає мінімуму сумарна ціна закупівлі тканини у заданому обсязі. 


---

## Математична модель задачі
**Дано**

$N$ - потрібна кількість тканини

$v_i$ - запаси тканини у $i$-того постачальника

$n_i$ - умова знижки у $i$-того постачальника

$C_i$ - звичайна ціна у $i$-того постачальника

$S_i$ - ціна зі знижкою у $i$-того постачальника

**Умови**

*Перша умова* гарантує, що сумарного запасу тканини у всіх постачальників достатньо для закупівлі необхідної кількості тканини. 

$\sum_{i=1}^{m} v_i > N$ , $i = \overline{1,m}$  

*Друга умова* гарантує, що ціна зі знижкою у одного постачальника буде нижчою ніж звичайна ціна, у того ж постачальника.

$S_i < C_i$ , $i = \overline{1,m}$  

*Третя умова* обмежує покупку потрібної кількості тканини лише зі знижкою.

$\sum_{i=1}^{m} n_i < N$ , $i = \overline{1,m}$ 

**Змінні**

$x_{ij}$ - кількість тканини, купленої у $i$ -того постачальника за $j$ -тою ціною

$$ {i = 1,2,...,m}; \hspace{1em} j =
  \begin{cases}
    1       & \quad \text{, звичайна ціна} \\
    2       & \quad \text{, ціна зі знижкою} 
  \end{cases}
$$

**Обмеження**

Сумарна кількість купленої тканини повинна задовольняти потребу покупця:

$\sum_{i=1}^{m} \sum_{j=1}^{2} x_{ij} = N$ , $\hspace{2em} i = \overline{1,m} \hspace{1em} j = \overline{1,2} \hspace{4em} \text{(1.1)}$
   
За умовою задачі, тканина може купитися за звичайною ціною та за ціною зі знижкою – з’являється умова дихотомії. Для того щоб позбутися її, вводимо m булевих змінних:

$$ y_i =
  \begin{cases}
    0       & \quad \text{, якщо тканина купляється за знижкою} \\
    1       & \quad \text{, інакше} 
  \end{cases}
$$

Нові обмеження будуть виглядати так:

$x_{i1} \leq (n_i - 1)y_i$ , $\hspace{3em} i = \overline{1,m} \hspace{9em} \text{(1.2)}$
 
$x_{i2} \geq n_i(1 - y_i)$ , $\hspace{3em} i = \overline{1,m} \hspace{9em} \text{(1.3)}$ 

$x_{i2} \leq My_i$ , $\hspace{5.3em} i = \overline{1,m} \hspace{9em} \text{(1.4)}$ 

$x_{i2} \leq v_i$ , $\hspace{6.3em} i = \overline{1,m} \hspace{9em} \text{(1.5)}$ 

$y_i \in B$ , $\hspace{6.9em} i = \overline{1,m}$ 

$x_{ij} \geq 0$ , $\hspace{6.8em} i = \overline{1,m} \hspace{1em} j = \overline{1,2}$ 

**Цільова функція**

Визначити обсяги закупівлі тканини у постачальників, при яких досягає *мінімуму сумарна ціна закупівлі* тканини у заданому обсязі.

$z = \sum_{i=1}^{m} C_i x_{i1} + \sum_{i=1}^{m} S_i x_{i2} \rightarrow{min}$ , $i = \overline{1,m}$ 



---

## Розробка алгоритмів розв’язання задачі

*«Задача про знижки»* відноситься до класу задач комбінаторної оптимізації. 

Ці задачі можуть бути розв'язані за допомогою *жадібного алгоритму*. Також були розроблені алгоритми *ТШ_1* та *ТШ_2*. 
Перший базується на основі наближеного методу Фогеля, другий – на прогрессивному оподаткуванні. 

### Жадібний алгоритм

**Опис алгоритму**
Головною ідеєю жадібного алгоритму, в умовах «Задача про знижки», є купити тканину за найменшою ціною та з найбільшою 
кількістю, аби швидше задовільнити потребу купця. 

Серед усіх звичайних цін та цін зі знижкою обирається найменша. Тканина буде закуплятись за найменшою вартістю. 
Розв’язком буде вважатись момент, коли потреби в тканині не буде. 


### Алгоритм ТШ_1

**Опис алгоритму**

Основною проблемою жадібного алгоритму для Задачі про знижки є неможливість спрогнозувати останні кроки закупки. 
На останніх ітераціях лише інколи вдається купити тканину за пониженою ціною, так як актуальна потреба в тканині не 
дозволяє виконувати умову знижки. Це призводить до підвищення кінцевої вартості. Наближений метод Фогеля розроблений 
з метою позбавлення цього недоліку.

**Розробка алгоритму ТШ_1 для розв’язання задачі**

Аби досягти мети, вводиться система штрафів. Для Задачі про знижки ці штрафи відповідають різниці звичайної ціни та ціни зі знижкою. 
Щоб не витрачати більше на останніх ітераціях, на перших кроках задовольняються умови знижок для найбільшої різниці в системі штрафів. 
Після кожної ітерації і виконання умов покупки за знижкою штраф у і-того постачальника анулюється. Коли всі штрафи досягають 
нульового стану, а потреба у тканині залишається, то виконується докупівля тканини за жадібним алгоритмом.

Метод Фогеля завжди приводить до допустимого розв’язку (коли потреби у тканині немає), тому що виконується перевірка 
актуальної потреби у тканині, як в жадібному алгоритмі. 

**Недоліки**

Іноді додаткові кроки алгоритму, які мають покращувати розв’язок, спричиняють умови, в яких отриманий розв’язок 
буде гіршим за розв’язок, отриманий за допомогою жадібного алгоритму. Ця проблема зазвичай виникає через неврахування 
спроможності взагалі уникнути купівлі тканини у постачальника, який пропонує свій товар за занадто високою ціною.

### Алгоритм ТШ_2

**Опис алгоритму:**
Даний алгоритм було розроблено після зміни умов вхідної задачі. Відтепер задача набуває «прогресивного» вигляду: 
ціна за тканину приймає не одне значення, а два. Іншими словами, після виконання умови знижки кожен додатковий метр 
буде куплятись за ціною знижки.

**Розробка алгоритму ТШ_2 для розв’язання задачі**

Для того, щоб зрозуміти, у яких постачальників краще купляти тканину, ми розраховуємо сумарні витрати при закупівлі певної кількості метрів. 

На кожному кроці ми визначаємо, яку мінімальну кількість товару можна закупити у тих постачальників, у котрих ще є запаси. Після цього доречним 
є порівняння цін у різних постачальників за дану кількість метрів тканини. Таким чином обирається локальна мінімальна 
витрата під час кожної ітерації. 

Допустимий розв’язок отримується завдяки перерахунку потреби у тканині. 